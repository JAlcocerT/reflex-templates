name: Create Artifacts on Push

on:
  push:
    branches:
      - alek/artifacts # Specify the branches you want to trigger this action on

jobs:
  create-artifacts:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.x"

      - name: Create artifacts
        run: |
          for dir in $(ls -d */); do
            zip_name="${dir%/}.zip"
            echo "Creating zip $zip_name"
            zip -r "$zip_name" "$dir"
          done
        shell: /bin/bash

      - name: Upload artifacts
        run: |
          for zip_file in *.zip; do
            echo "Uploading $zip_file"
            gh_path="$zip_file"
            echo "::set-output name=artifact_name::$zip_file"
            echo "::set-output name=artifact_path::$zip_file"
          done
        shell: /bin/bash

      - name: Upload artifacts
        uses: actions/upload-artifact@v3
        with:
          name: subfolder-artifacts
          path: "*.zip"
